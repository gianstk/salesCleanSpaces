<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>CleanSpace Halo ROI calculator</title>


    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <!-- chart JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
    

    <style>
      * {
        font-family: 'Raleway', sans-serif;
      }
      .center-button {
        text-align: center;
      }
      .table-curved {
        border: solid #ccc 1px;
        border-radius: 6px;
        border-left:0px;  
      }
    </style>

  </head>



  <body>

    <nav class="navbar navbar-expand-sm navbar-light bg-light">
      <a class="navbar-brand" href="#">Clean Space</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link region-reload" href="#en">
              English
              <span class="sr-only">(current</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link region-reload" href="#fr">
              France
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link region-reload" href="#ge">
              German
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid">
      <h1>Cost Comparison</h1>
      <p id="siteDescription">Online ROI CleanSpace vs Disposable Mask Calculator</p>
      
      <!-- Top table -->
      <h3>CleanSpace System - Health and Life Science</h3>
      <div class="row">
        <!-- Health left table -->
        <div class="col-md-6">
          <table id="model-table" class="table table-success" width="100%">
            <tbody>
              <th id="modelHeader">Model</th>
              <th id="modelCostUnit">$</th>

              <tr>
                <td id="model1Text">CleanSpace Halo + Half mask</td>
                <td><input id="model1Value" class="haloCalculation" value="905" type="number"></td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Health right table -->
        <div class="col-md-6">
          <table id="filter-table" class="table table-success" width="100%">
            <tbody>
              <th id="otherHeader">Other</th>
              <th id="otherCostUnit">$</th>

              <!-- fp: filter particulate -->
              <tr>
                <td id="fpText">Filter particulate</td>
                <td><input id="fpValue" class="haloCalculation" type="number" value="20"></td>
              </tr>
              <!-- fpm: filter per month -->
              <tr>
                <td id="fpmText">Filter used per month</td>
                <td><input id="fpmValue" class="haloCalculation" type="number" value="2"></td>
              </tr>
              <!-- acm: annual cost of maintenance -->
              <tr>
                <td id="acmText">Annual cost of maintenance</td>
                <td><input id="acmValue" class="haloCalculation" type="number" value="0"></td>
              </tr>

            </tbody>
          </table>
        </div>
      </div>

      <!-- Bottom Table -->
      <h3>Disposable Mask</h3>      
      <table width="100%" class="table table-success">
        <tbody>
          <tr>
            <td>Number of masks used per month</td>
            <td><input id="disposableNumber" class="disposableCalculation" type="number" value="40"></td>
          </tr>

          <tr>
            <td>Price per unit</td>
            <td><input id="disposablePrice" class="disposableCalculation" type="number" value="2"></td>
          </tr>

          <tr>
            <td>Monthly cost</td>
            <td id="disposableTotalCost"></td>
          </tr>
        </tbody>
      </table>
      
      <!-- Calculate button -->
      <div class="row">
        <div class="col-md-12">
          <div class="center-button">
            <button type="button" class="btn btn-primary btn-lg btn-success center" onclick="calculateFunction()">Calculate</button>
          </div>
        </div>
      </div>

      <h3>Savings</h3>
      <!-- Result -->
      <div class="row">
        <!-- Result calculation -->
        <div class="col-md-6">
          <table width="100%" class="table table-success">
            <tbody>
              <tr>
                <th>Units</th>
                <th>Total Cost Over 1 Year</th>
                <th>Total Cost Over 3 Years</th>
                <th>%</th>
              </tr>

              <!-- Disposable Mask -->
              <tr>
                <td>Disposable Masks</td>
                <td id="cost_disposable1y">0</td>
                <td id="cost_disposable3y">0</td>
                <td id="disposablePercentage">0</td>
              </tr>

              <!-- CleanSpace Halo + Half Mask -->
              <tr>
                <td>CleanSpace Halo + Half mask</td>
                <td id="cost_halo1y">0</td>
                <td id="cost_halo3y">0</td>
                <td id="haloPercentage">0</td>
              </tr>

            </tbody>
          </table>
        </div>

        <!-- Plotted diagram -->
        <div class="col-md-6">
          <canvas id="canvas" width="400" height="400">
          <script>
            
            // var labels = ['Disposable Mask', 'Halo-half Mask'];
            var color = Chart.helpers.color;
            var barChartData = {
              labels: ['Disposable Masks', 'Halo-Half Mask'],
              datasets: [
                {
                  label: 'Disposable Mask',
                  backgroundColor: 'rgb(255, 0, 0, 0.6)',
                  borderColor: 'rgb(255, 99, 132)',
                  borderWidth: 1,
                  data: [0, 0]
                },
                {
                  label: 'Halo-half Mask',
                  backgroundColor: 'rgb(0, 204, 0, 0.6)',
                  borderColor: 'rgb(0, 204, 0)',
                  borderWidth: 1,
                  data: [0, 0]
              }
              ]
            }

            var ctx = document.getElementById('canvas').getContext('2d');
            var myChart;

            // $(document).ready(function() {
              
            //   // input change???
            //   myChart = new Chart(ctx, {
            //     type: 'bar',
            //     data: barChartData,
            //     options: {
            //       scales: {
            //         xAxes: [{
            //           stacked: true,
            //         }],
            //         yAxes: [{
            //           stacked: true,
            //           ticks: {
            //             beginAtZero: true
            //           }
            //         }]
            //       },
            //       responsive: true,
            //       maintainAspectRatio: false,
            //       legend: {
            //         position: 'top',
            //       },
            //       title: {
            //         display: true,
            //         text: 'Overall Cost of 3 years'
            //       }
            //     }
            //   });
              
            // });
            
            

          </script>
        </div>
      </div>

    </div>

  

    <!-- Changing language script -->
    <script>
      // health table value in different languages
      var healthTableLang = {
        en: {
          siteDescription: "Online ROI CleanSpace vs Disposable Mask Calculator",
          modelHeader: "Model",
          otherHeader: "Other",
          costUnit: "$",
          model1: {text: "CleanSpace Halo + Half mask", value: 905},
          fpm: {text: "Filter used per month", value: 20},
          acm: {text: "Annual cost of maintenance", value: 0}
        },
        fr: {
          siteDescription: "COMPARATIF DE COÛT D'UTILISATION CLEANSPACE / MASQUE PAPIER FFP3",
          modelHeader: "RRP",
          otherHeader: "Other",
          costUnit: "€",
          model1: {text: "CleanSpace Halo + demi-masque", value: 750},
          fpm: {text: "Filtre P3 Halo", value: 2},
          acm: {text: "Coût annuel de maintenance", value: 0}
        },
        ge: {
          siteDescription: "Online ROI CleanSpace vs Disposable Mask Calculator",
          modelHeader: "Model",
          otherHeader: "Other",
          costUnit: "£",
          model1: {text: "CleanSpace Halo + Half mask", value: 905},
          fpm: {text: "Filter used per month", value: 2},
          acm: {text: "Annual cost of maintenance", value: 0}
        }
      }
      

      
      

      $(document).ready(function () {
        // set up myChart
        myChart = new Chart(ctx, {
          type: 'bar',
          data: barChartData,
          options: {
            scales: {
              xAxes: [{
                stacked: true,
              }],
              yAxes: [{
                stacked: true,
                ticks: {
                  beginAtZero: true
                }
              }]
            },
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: 'top',
            },
            title: {
              display: true,
              text: 'Overall Cost of 3 years'
            }
          }
        });

        // dynamic active navigation bar
        var nav_lang = ["#en", "#fr", "#ge"];
        $(".nav-item").each(function(i) {
          if (window.location.hash == nav_lang[i]) $(this).addClass('active');
          else if (this.className.includes('active')) $(this).removeClass('active');
        })

        // define language
        if (window.location.hash) {
          switch(window.location.hash) {
            case "#en":
              setHealthTableLanguage("en")
              break;
            case "#fr":
              setHealthTableLanguage("fr")
              break;
            case "#ge":
              setHealthTableLanguage("ge")
              break;
          }
        }

        // use passed parameters
        paramPassing();

        // reload page after changing language
        $(".region-reload").click(function () {
          setTimeout(function () { location.reload(true); }, 50);
        });
        
        // re-calculate disposable mask price when input has been changed
        $(".disposableCalculation").change( function () {
          calculateDisposable();
          calculateFunction();
        })

        // re-calculate when there is a change
        $(".haloCalculation").change( function () {
          calculateDisposable();
          calculateFunction();
        })



        
      });
    

      

      // function for changing language of a whole site
      function setHealthTableLanguage(lang) {
        // site description
        siteDescription.innerHTML = healthTableLang[lang]["siteDescription"];

        // header & cost unit
        modelHeader.textContent = healthTableLang[lang]["modelHeader"];
        otherHeader.textContent = healthTableLang[lang]["otherHeader"];
        modelCostUnit.textContent = otherCostUnit.textContent = healthTableLang[lang]["costUnit"];

        // model 1
        model1Text.textContent = healthTableLang[lang]["model1"]["text"];
        model1Value.value = healthTableLang[lang]["model1"]["value"];
        
        // fpm
        fpmText.textContent = healthTableLang[lang]["fpm"]["text"];
        fpmValue.value = healthTableLang[lang]["fpm"]["value"];
        // acm
        acmText.textContent = healthTableLang[lang]["acm"]["text"];
        acmValue.value = healthTableLang[lang]["acm"]["value"];
      }

      // function for calculating disposable mask price
      function calculateDisposable() {
        var dispMaskNumber = parseFloat($("#disposableNumber").val());
        var dispMaskPrice = parseFloat($('#disposablePrice').val());
        var dispMonthlyCost = dispMaskNumber * dispMaskPrice;
        $("#disposableTotalCost").html(dispMonthlyCost);
        return {cost1y: dispMonthlyCost*12, cost3y:dispMonthlyCost*36}
      }

      // CleanSpace mask calculation function
      function calculateCleanSpace() {
        var haloHalfMask = parseFloat($("#model1Value").val());
        var fpValue = parseFloat($("#fpValue").val());
        var fpmValue = parseFloat($("#fpmValue").val());
        var acmValue = parseFloat($("#acmValue").val());
        
        var filter_1y = (fpValue * fpmValue * 12) + acmValue;
        var filter_3y = filter_1y * 3;
        var haloHalfMask_1y = haloHalfMask + filter_1y
        var haloHalfMask_3y = haloHalfMask + filter_3y;
        return {cost1y: haloHalfMask_1y, cost3y: haloHalfMask_3y}
      }

      // main calculating function
      function calculateFunction() {
        var dispCost = calculateDisposable();
        var cleanSpaceCost = calculateCleanSpace();
        var diffPercen = (cleanSpaceCost["cost3y"] - dispCost["cost3y"])/dispCost["cost3y"];
        var formattedPercen = Math.round(diffPercen * 100).toFixed();

        $("#cost_halo1y").html(cleanSpaceCost["cost1y"]);
        $("#cost_halo3y").html(cleanSpaceCost["cost3y"]);
        $("#cost_disposable1y").html(dispCost["cost1y"]);
        $("#cost_disposable3y").html(dispCost["cost3y"]);
        $("#haloPercentage").html(formattedPercen);

        // Disposable chart value
        myChart.data.datasets[0].data = [
          dispCost["cost3y"],
          0
          
        ]
        // Halo-half chart value
        myChart.data.datasets[1].data = [
          // cleanSpaceCost["cost1y"], 
          0,
          cleanSpaceCost["cost3y"]
        ]
        myChart.update(); 
      }

      // parameters passing function
      function paramPassing() {
        const params = new URLSearchParams(window.location.search);
        // Halo price
        if (params.has("haloPrice")) {
          $("#model1Value").val(params.get("haloPrice"));
        }
        // Filter participate
        if (params.has("haloFp")) {
          $("#fpValue").val(params.get("haloFp"));
        }
        // Filters used per month
        if (params.has("haloFpm")) {
          $("#fpmValue").val(params.get("haloFpm"));
        }
        // Annual cost of maintenance
        if (params.has("haloAcm")) {
          $("#acmValue").val(params.get("haloAcm"));
        }
        // Number of disposable masks used per month
        if (params.has("dispMpm")) {
          $("#disposableNumber").val(params.get("dispMpm"));
        }
        // Disposable price per unit
        if (params.has("dispPrice")) {
          $("#disposablePrice").val(params.get("dispPrice"));
        }
      }

      

    </script>

  </body>

  <script>

  </script>



</html>